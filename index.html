<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="favicon.ico" />
    <script type="module" src="/src/bootstrap.js"></script>
    <link rel="stylesheet" href="/src/styles.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pointillate</title>
  </head>
  <body>
    <div id="app" class="loading">
      <div id="titlePane">
        <h1 class="title">POINTILLATE</h1>
      </div>
      <!-- <div id="loader" class="loader"></div> -->

      <div id="canvasStage">
        <div id="canvasVisual">
          <canvas id="canvas"></canvas>
        </div>
      </div>

      <div id="controlPane">
        <div id="controlDock">

          <wa-button id="infoButton" size="small" appearance="filled"
            aria-label="About">
            <wa-icon name="info"></wa-icon>
          </wa-button>

          <wa-button id="optionsButton" size="small" appearance="filled"
            aria-label="Edit options">
            <wa-icon id="optionsIcon" name="sliders"></wa-icon>
          </wa-button>

          <wa-button id="uploadButton" size="small" appearance="filled"
            aria-label="Choose file">
            <wa-icon name="camera"></wa-icon>
          </wa-button>

          <wa-button appearance="filled" id="resetButton"
            size="small" aria-label="Reset"><wa-icon
              name="arrows-rotate"></wa-icon></wa-button>

          <wa-button id="runButton" size="small" appearance="filled"
            aria-label="Play/Pause">
            <wa-icon id="runIcon" name="play"></wa-icon>
          </wa-button>

        </div>

        <div id="controlCarousel">
          <div class="carouselPad">

            <div class="controlTrack">

              <div class="controlCard pickerWidth">
                <div class="colorPickers">
                  <wa-color-picker id="backgroundColorBtn" label="Canvas"
                    placement="left" hoist
                    value="#FFFFFF" size="small"
                    swatches="#000; #fff"></wa-color-picker>
                  <wa-color-picker id="pointColorBtn" label="Seeds"
                    value="#000000" size="small"
                    swatches="#000; #fff"></wa-color-picker>
                  <wa-color-picker id="lineColorBtn" label="Cells"
                    value="#000000" size="small"
                    swatches="#000; #fff"></wa-color-picker>
                </div>
              </div>

              <div class="controlCard showToggles" id="cardToStart">
                <div class="togglesGrid">
                  <wa-button appearance="filled" id="seedToggle"
                    class="leftToggle"
                    aria-pressed="true">Seeds</wa-button>
                  <wa-button appearance="filled" id="colorToggle"
                    class="rightToggle"
                    aria-pressed="false">Color</wa-button>
                  <wa-button appearance="filled" id="cellToggle"
                    class="leftToggle"
                    aria-pressed="false">Cells</wa-button>
                  <wa-button appearance="filled" id="fillToggle"
                    class="rightToggle"
                    aria-pressed="false">Fill</wa-button>
                </div>
              </div>

              <div class="controlCard sliderWidth">
                <wa-slider with-tooltip
                  id="numPointsSlider"
                  label="Seed Count"
                  min="1000"
                  max="30000"
                  value="5000"
                  step="1000">
                </wa-slider>
              </div>

              <div class="controlCard">
                <wa-select id="seedSelect" size="medium" label="Start from">
                  <wa-option value="dark" icon-placement="start"
                    label="Dark Areas">Dark
                    Areas</wa-option>
                  <wa-option value="light" icon-placement="start"
                    label="Light Areas">Light Areas</wa-option>
                  <wa-option value="none" icon-placement="start"
                    label="All Over" selected>All Over</wa-option>
                </wa-select>
              </div>

              <div class="controlCard">
                <wa-select id="relaxSelect" size="medium" label="Gravitate to">
                  <wa-option value="dark" label="Dark Areas"
                    selected>Dark Areas</wa-option>
                  <wa-option value="light" label="Light Areas">Light
                    Areas</wa-option>
                </wa-select>
              </div>

              <div class="controlCard">
                <wa-select id="sizeSelect" size="medium" label="Size by">
                  <wa-option value="dark" label="Darkness"
                    selected>Darkness</wa-option>
                  <wa-option value="light"
                    label="Lightness">Lightness</wa-option>
                  <wa-option value="none"
                    label="Nothing">Nothing</wa-option>
                </wa-select>
              </div>
              <div class="controlCard sliderWidth">
                <wa-slider range with-tooltip
                  id="radiusRange"
                  label="Seed Size"
                  min="0"
                  max="20"
                  value="4"
                  min-value="1"
                  max-value="10"
                  step="1"></wa-slider>
                <wa-slider with-tooltip
                  id="radiusSlider"
                  label="Seed Size"
                  min="0"
                  max="20"
                  value="2"
                  step="1"
                  style="display:none;">
                </wa-slider>
              </div>

              <div class="controlCard sliderWidth">
                <wa-slider with-tooltip
                  id="speedSlider"
                  label="Speed"
                  min="0"
                  max="1"
                  value="0.1"
                  step="0.01"></wa-slider>
              </div>

              <div class="controlCard saveButtonCard"
                style="position:relative;">
                <div class="cardCenter">
                  <wa-dropdown id="saveDropdown" placement="top-middle">
                    <wa-button size="large" slot="trigger"
                      appearance="filled"><wa-icon
                        name="download"></wa-icon></wa-button>
                    <wa-dropdown-item value="png">PNG</wa-dropdown-item>
                    <wa-dropdown-item value="json">JSON</wa-dropdown-item>
                  </wa-dropdown>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="infoOverlay" class="info-overlay" hidden>
      <div class="info-panel-outer">
        <div class="info-panel-inner">
          <wa-button id="closeInfo" size="medium" appearance="plain"
            aria-label="Close">
            <wa-icon name="close"></wa-icon>
          </wa-button>
          <h1>Pointillate</h1>
          <p class="byline">By <a href="http://www.willkoeppen.com/datavis">Will
              Koeppen</a></p>
          <p>This app uses a reference image to seed a canvas using randomized
            exclusion sampling. Seeds are iteratively moved to new positions by
            using Lloyd's algorithm with a density function based on the
            reference.</p>
          <h3>Background</h3>
          <p>Artists have used distributed dots (stippling) for shading since at
            least <a href="https://en.wikipedia.org/wiki/Stipple_engraving">1510
              AD</a>. In the late 1800s, the <a
              href="https://en.wikipedia.org/wiki/Pointillism">Pointillism</a>
            movement shed lines altogether and used only dots to create
            forms.</p>
          <p>Computer scientists like <a
              href="https://kops.uni-konstanz.de/server/api/core/bitstreams/357c2128-47cb-44bf-ac9d-734cdf9012a6/content">Deussen
              et al. (2000)</a> and <a
              href="https://www.cs.ubc.ca/labs/imager/tr/2002/secord2002b/secord.2002b.pdf">Secord
              (2002)</a> explored algorithms to apply stippling to digital
            images. Their goal was to use math and CPU power to represent
            objects with far fewer well-placed dots than you would need for a
            full resolution image. </p>
          <p>As a lover of art and animation, I'm very interested in the idea of
            visual sufficiency. How little of something can you show and have
            people recognize what it is? I'm also interested in movement in
            general and the emotions it can evoke, and this is a way to add
            movement to static image.</p>
          <h3>Start with Seeds</h3>
          <p>You may already have experience creating a seed mosaic in an art
            class. First, apply glue to a canvas only in areas where you want
            seeds to stick. Then you'd start placing seeds one by one.</p>
          <p>In this version, we're less careful. We count out
            10,000 seeds and throw them at the canvas en masse. Some will stick
            to the gluey areas. We'll pick up the seeds that didn't and throw
            them again and again until they're all hanging on.</p>
          <h3>Learn to Relax</h3>
          <p>Since we didn't carefully place the seeds, some will be stuck to
            the canvas close together, and some areas that had glue will still
            have gaps. We need them to spread out a little.</p>
          <p>If you've ever been in a packed subway car when suddenly half of
            the people get off at a popular stop, you've approximated the
            movement described by <a
              href="https://en.wikipedia.org/wiki/Lloyd%27s_algorithm">Lloyd's
              Algorithm</a>. There's a collective sigh of relief from the
            remaining riders, and we all take a few steps away from the squished
            person next to us until we reach a new, more comfortable
            equilibrium.</p>
          <h3>Gravitate</h3>
          <p>Following the vanilla version of Lloyd's Algorithm to its
            mathematical
            conclusion would lead all of our seeds to be exactly equidistant
            from each other. Well ordered, but not very interesting if they
            should be representing an image. Instead, we want seeds to be
            relaxed, but still grouped (weighted) towards certain areas of the
            canvas.</p>
          <p>What has weight? For humans, we might gravitate towards the
            fireplace in a cold room, the kitchen at a party, or around a piano
            player in Grand Central Station. For this project we re-use our
            reference
            image, and we can choose if the dark or the light pixels should have
            gravity to attract our seeds.</p>
          <h3>Play</h3>
          <p>The goal of the “Weighted Voronoi Stippling” of Secord (2002) was
            to quickly render an image with dots. To replicate their work on
            your image, use uniformly-sized seeds on a white canvas, start from
            dark areas, and let the seeds relax over them.</p>
          <p>Or, "<a
              href="https://archive.nytimes.com/tmagazine.blogs.nytimes.com/2013/05/09/yes-please-party-of-one/">swim
              far out if you want to.</a>"
            We can seed the canvas in light areas, but gravitate towards dark
            areas
            of the image, or vice versa. We can set the size of the seeds to
            reflect the gravity. Instead of the seeds, we can show the
            boundaries between the seeds (cells). We can swap the colors of the
            seeds and the canvas, or color the seeds based on the underlying
            reference image.</p>
          <p>This process is non-deterministic, so your animation will be
            different every time.</p>
          <h3>Tips</h3>
          <ul>
            <li>Edit your photo and/or video before adding it as a
              reference</li>
            <li>Images with a high-contrast subject work well</li>
            <li>After things look settled, try changing things up</li>
            <li>For images, try slowing the relaxation speed down a lot</li>
          </ul>
          <h3>Acknowledgements</h3>
          <p>Daniel Shiffman's <a
              href="https://thecodingtrain.com/challenges/181-image-stippling">Coding
              Train Challenge #181</a> was an excellent resource. <a
              href="https://github.com/smallwhale1/voronoi-stippling/tree/main">Sophie
              Zhang</a>'s response to the challenge was an inspiring seed for my
            own iteration.</p>

        </div>
      </div>
    </div>

    <div class="behindTheVeil">
      <video id="video" playsinline muted></video>
      <input
        type="file"
        aria-label="Upload image or video"
        id="mediaUploadDialog"
        accept="image/*,video/*,.mp4,.mov,.webm"
        tabindex="-1" />
    </div>

  </body>
</html>